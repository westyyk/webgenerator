<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª–µ–π</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê –ì–ï–ù–ï–†–ê–¢–û–† –ü–ê–†–û–õ–ï–ô</h1>
            <p>–°–æ–∑–¥–∞–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–æ–ª—å –∑–∞ —Å–µ–∫—É–Ω–¥—ã</p>
        </div>

        <div class="controls">
            <div class="form-group">
                <label for="level">–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</label>
                <select id="level">
                    <option value="Light">Light (–ª—ë–≥–∫–∏–π)</option>
                    <option value="Medium" selected>Medium (—Å—Ä–µ–¥–Ω–∏–π)</option>
                    <option value="Hard">Hard (—Å–ª–æ–∂–Ω—ã–π)</option>
                </select>
                <div class="level-info" id="levelInfo">
                    –ë—É–∫–≤—ã, 8-12 —Å–∏–º–≤–æ–ª–æ–≤
                </div>
            </div>

            <button class="btn" onclick="generatePassword()">
                –°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –ü–ê–†–û–õ–¨
            </button>
        </div>

        <div class="result" id="result">
            <h3>–í–∞—à —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å:</h3>
            <div class="password-display" id="password"></div>
            <button class="copy-btn" onclick="copyPassword()">
                üìã –ö–û–ü–ò–†–û–í–ê–¢–¨ –í –ë–£–§–ï–† –û–ë–ú–ï–ù–ê
            </button>
        </div>
    </div>

    <script>
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Ä–æ–≤–Ω–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        document.getElementById('level').addEventListener('change', function() {
            const levelInfo = {
                'Light': '–¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, 6-8 —Å–∏–º–≤–æ–ª–æ–≤',
                'Medium': '–ë—É–∫–≤—ã + —Ü–∏—Ñ—Ä—ã, 8-12 —Å–∏–º–≤–æ–ª–æ–≤',
                'Hard': '–ë—É–∫–≤—ã + —Ü–∏—Ñ—Ä—ã + —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã, 12-16 —Å–∏–º–≤–æ–ª–æ–≤'
            };
            document.getElementById('levelInfo').textContent = levelInfo[this.value];
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('level').dispatchEvent(new Event('change'));
        });

        async function generatePassword() {
            const level = document.getElementById('level').value;
            const button = document.querySelector('.btn');

            // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
            button.textContent = '–ì–ï–ù–ï–†–ê–¶–ò–Ø...';
            button.disabled = true;

            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `level=${level}`
                });

                const data = await response.json();

                if (data.password) {
                    document.getElementById('password').textContent = data.password;
                    const resultDiv = document.getElementById('result');
                    resultDiv.style.display = 'block';
                    resultDiv.classList.add('fade-in');
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + data.error);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + error.message);
            } finally {
                button.textContent = '–°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –ü–ê–†–û–õ–¨';
                button.disabled = false;
            }
        }

        function copyPassword() {
            const password = document.getElementById('password').textContent;
            navigator.clipboard.writeText(password).then(() => {
                const copyBtn = document.querySelector('.copy-btn');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '‚úì –°–ö–û–ü–ò–†–û–í–ê–ù–û!';
                copyBtn.style.backgroundColor = '#333';

                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.style.backgroundColor = '';
                }, 2000);
            }).catch(err => {
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å: ' + err);
            });
        }
    </script>
</body>
</html>